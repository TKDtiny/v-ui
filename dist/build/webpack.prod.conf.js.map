{"version":3,"sources":["../../build/webpack.prod.conf.js"],"names":["path","require","utils","webpack","config","merge","baseWebpackConfig","CopyWebpackPlugin","HtmlWebpackPlugin","ExtractTextPlugin","OptimizeCSSPlugin","env","build","glob","webpackConfig","module","rules","styleLoaders","sourceMap","productionSourceMap","extract","devtool","output","assetsRoot","filename","assetsPath","chunkFilename","plugins","DefinePlugin","optimize","UglifyJsPlugin","compress","warnings","cssProcessorOptions","safe","HashedModuleIdsPlugin","CommonsChunkPlugin","name","minChunks","count","resource","test","indexOf","join","__dirname","chunks","from","resolve","to","assetsSubDirectory","ignore","productionGzip","CompressionWebpackPlugin","push","asset","algorithm","RegExp","productionGzipExtensions","threshold","minRatio","exports","getEntry","globPath","entries","basename","tmp","pathname","forEach","itemPath","sync","entry","extname","split","length","splice","pages","conf","template","minify","removeComments","collapseWhitespace","removeAttributeQuotes","inject","chunksSortMode","hash"],"mappings":"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","file":"webpack.prod.conf.js","sourcesContent":["var path = require('path')\r\nvar utils = require('./utils')\r\nvar webpack = require('webpack')\r\nvar config = require('../config')\r\nvar merge = require('webpack-merge')\r\nvar baseWebpackConfig = require('./webpack.base.conf')\r\nvar CopyWebpackPlugin = require('copy-webpack-plugin')\r\nvar HtmlWebpackPlugin = require('html-webpack-plugin')\r\nvar ExtractTextPlugin = require('extract-text-webpack-plugin')\r\nvar OptimizeCSSPlugin = require('optimize-css-assets-webpack-plugin')\r\n\r\nvar env = config.build.env\r\nvar glob = require('glob');\r\n\r\nvar webpackConfig = merge(baseWebpackConfig, {\r\n  module: {\r\n    rules: utils.styleLoaders({\r\n      sourceMap: config.build.productionSourceMap,\r\n      extract: true\r\n    })\r\n  },\r\n  devtool: config.build.productionSourceMap ? '#source-vmap' : false,\r\n  output: {\r\n    path: config.build.assetsRoot,\r\n    filename: utils.assetsPath('js/[name].[chunkhash].js'),\r\n    chunkFilename: utils.assetsPath('js/[id].[chunkhash].js')\r\n  },\r\n  plugins: [\r\n    // http://vuejs.github.io/vue-loader/en/workflow/production.html\r\n    new webpack.DefinePlugin({\r\n      'process.env': env\r\n    }),\r\n    new webpack.optimize.UglifyJsPlugin({\r\n      compress: {\r\n        warnings: false\r\n      },\r\n      sourceMap: true\r\n    }),\r\n    // extract css into its own file\r\n    new ExtractTextPlugin({\r\n      filename: utils.assetsPath('css/[name].[contenthash].css')\r\n    }),\r\n    // Compress extracted CSS. We are using this plugin so that possible\r\n    // duplicated CSS from different components can be deduped.\r\n    new OptimizeCSSPlugin({\r\n      cssProcessorOptions: {\r\n        safe: true\r\n      }\r\n    }),\r\n    // generate dist shop.html with correct asset hash for caching.\r\n    // you can customize output by editing /shop.html\r\n    // see https://github.com/ampedandwired/html-webpack-plugin\r\n    // TODO 注释以下代码 ，默认生成\r\n    // new HtmlWebpackPlugin({\r\n    //   filename: config.build.index1,\r\n    //   template: 'index1.html',\r\n    //   inject: true,\r\n    //   minify: {\r\n    //     removeComments: true,\r\n    //     collapseWhitespace: true,\r\n    //     removeAttributeQuotes: true\r\n    //     // more options:\r\n    //     // https://github.com/kangax/html-minifier#options-quick-reference\r\n    //   },\r\n    //   // necessary to consistently work with multiple chunks via CommonsChunkPlugin\r\n    //   chunksSortMode: 'dependency'\r\n    // }),\r\n    // keep module.id stable when vender modules does not change\r\n    new webpack.HashedModuleIdsPlugin(),\r\n    // split vendor js into its own file\r\n    new webpack.optimize.CommonsChunkPlugin({\r\n      name: 'vendor',\r\n      minChunks: function (module, count) {\r\n        // any required modules inside node_modules are extracted to vendor\r\n        return (\r\n          module.resource &&\r\n          /\\.js$/.test(module.resource) &&\r\n          module.resource.indexOf(\r\n            path.join(__dirname, '../node_modules')\r\n          ) === 0\r\n        )\r\n      }\r\n    }),\r\n    // extract webpack runtime and module manifest to its own file in order to\r\n    // prevent vendor hash from being updated whenever app bundle is updated\r\n    new webpack.optimize.CommonsChunkPlugin({\r\n      name: 'manifest',\r\n      chunks: ['vendor']\r\n    }),\r\n    // copy custom static assets\r\n    new CopyWebpackPlugin([\r\n      {\r\n        from: path.resolve(__dirname, '../static'),\r\n        to: config.build.assetsSubDirectory,\r\n        ignore: ['.*']\r\n      }\r\n    ])\r\n  ]\r\n})\r\n\r\nif (config.build.productionGzip) {\r\n  var CompressionWebpackPlugin = require('compression-webpack-plugin')\r\n\r\n  webpackConfig.plugins.push(\r\n    new CompressionWebpackPlugin({\r\n      asset: '[path].gz[query]',\r\n      algorithm: 'gzip',\r\n      test: new RegExp(\r\n        '\\\\.(' +\r\n        config.build.productionGzipExtensions.join('|') +\r\n        ')$'\r\n      ),\r\n      threshold: 10240,\r\n      minRatio: 0.8\r\n    })\r\n  )\r\n}\r\n\r\nmodule.exports = webpackConfig\r\n//添加以下代码  module.exports = webpackConfig 之后\r\nfunction getEntry(globPath) {\r\n  var entries = {},\r\n    basename, tmp, pathname;\r\n  if (typeof (globPath) != \"object\") {\r\n    globPath = [globPath]\r\n  }\r\n  globPath.forEach((itemPath) => {\r\n    glob.sync(itemPath).forEach(function (entry) {\r\n      basename = path.basename(entry, path.extname(entry));\r\n      if (entry.split('/').length > 4) {\r\n        tmp = entry.split('/').splice(-3);\r\n        pathname = tmp.splice(0, 1) + '/' + basename; // 正确输出js和html的路径\r\n        entries[`${pathname}`] = entry;\r\n      } else {\r\n        pathname = \"/\" + basename;\r\n        entries[basename] = entry;\r\n      }\r\n\r\n    });\r\n  });\r\n  return entries;\r\n}\r\n//获取指定目录下的html\r\nvar pages = getEntry(['./src/module/*.html', './src/module/**/*.html']);\r\nfor (var pathname in pages) {\r\n  // 配置生成的html文件，定义路径等\r\n  var conf = {\r\n    filename: pathname + '.html',\r\n    template: pages[`${pathname}`],   // 模板路径\r\n    minify: {                   //\r\n      removeComments: true,\r\n      collapseWhitespace: true,\r\n      removeAttributeQuotes: true\r\n    },\r\n    inject: true,             // js插入位置\r\n    // necessary to consistently work with multiple chunks via CommonsChunkPlugin\r\n    chunksSortMode: 'dependency',\r\n  };\r\n  if (pathname in module.exports.entry) {\r\n    conf.chunks = ['manifest', 'vendor', pathname];\r\n    conf.hash = true;\r\n  }\r\n  //添加到数组\r\n  module.exports.plugins.push(new HtmlWebpackPlugin(conf));\r\n}\r\n"]}